# Silver Key Realty — Cursor Rules
# Version 3.0 | Last Updated: Feb 2026
# This file instructs Cursor AI on how to work with this codebase.

## Project Context
Silver Key Realty is a lifestyle investment real estate company. The website is the primary intake mechanism — it identifies user type (Buyer, Seller, Investor, Renter) and routes them into dedicated experience pathways. The brand voice is elevated, intentional, and quiet. Never commercial. Never loud.

## Critical Rules — NEVER Break These

### 1. Design Tokens
- ALWAYS use CSS custom properties from `assets/css/tokens.css`
- NEVER hardcode hex colors, font stacks, or spacing values
- If a token doesn't exist for your use case, add it to tokens.css first

### 2. Green Recessed Lighting System
This is the signature design element. Green (#2E7D52) is NEVER used as solid paint.
It functions as ambient light — glow, edge, shadow only.
- Ambient glow: 3-8% opacity (--skr-green-ghost, --skr-green-glow)
- Edge lines: 18% opacity (--skr-green-line)
- Shadow/depth: 12% opacity (--skr-green-shadow)
- Hover effects: ≤50% opacity
- Text labels: ≤70% opacity (--skr-green-light)
- NEVER use --skr-green at full opacity on backgrounds, borders, or surfaces

### 3. Typography
- Serif: Cormorant Garamond (headlines, quotes, numbers) — weights 300-600
- Sans: Outfit (body, labels, CTAs) — weights 200-500
- NO other fonts. Ever.
- Italic serif ALWAYS uses var(--champagne) color
- Body weight is 200 (emphasis is 400, NEVER 700+)

### 4. Animation
- Global easing: cubic-bezier(0.22, 1, 0.36, 1) via var(--ease-out)
- Scroll reveals: Add class="reveal" — handled by reveal.js
- Stagger delay: 80ms between siblings
- Hover transitions: 0.4-0.6s

### 5. Voice & Copy
- Elevated but accessible. Quiet authority. Slow pace.
- NO exclamation marks. Ever.
- Serif italic for emotional/emphasized words
- Short paragraphs. Let the whitespace speak.
- The user should feel assessed, not sold to

## File Structure
```
index.html              ← Landing page (pathway selector lives here)
buyer/index.html        ← Buyer journey (stub — needs content)
seller/index.html       ← Seller journey (stub — needs content)
investor/index.html     ← Investor journey (stub — needs content)
rentals/index.html      ← Renter routing (stub — needs content)
assets/
  css/
    tokens.css          ← Design tokens (source of truth)
    base.css            ← Reset, typography, buttons, reveal, grain
    nav.css             ← Fixed navigation component
    hero.css            ← Hero section
    pathways.css        ← Pathway selector cards
    sections.css        ← Philosophy, pillars, feature, quote, lifestyle, cta, footer
    responsive.css      ← All breakpoint overrides (900px primary, 480px secondary)
  js/
    nav.js              ← Scroll state + mobile toggle + smooth scroll
    reveal.js           ← IntersectionObserver scroll animations
    pathways.js         ← Card interactions + future routing
  images/
    logo-transparent.png
docs/
  pathway-specs.md      ← Detailed pathway content requirements
  copy-bank.md          ← All approved copy
```

## New Component Checklist
When creating ANY new component:
- [ ] Uses CSS variables from tokens.css (zero hardcoded values)
- [ ] Has scroll reveal animation (class="reveal")
- [ ] Green effects follow recessed lighting rules above
- [ ] Typography matches hierarchy (serif headlines, sans body)
- [ ] Works at 900px breakpoint (add overrides in responsive.css)
- [ ] Hover states use var(--ease-out) easing
- [ ] Copy follows voice guidelines (no exclamation marks, quiet tone)

## Pathway Pages — What's Needed
Each pathway stub (buyer/, seller/, investor/, rentals/) currently has:
- Nav with back-links to landing page
- Hero with pathway-specific headline
- Footer

Each pathway NEEDS (see docs/pathway-specs.md):
- **Buyer**: Education progression → Search criteria → Attorney matching → Consultation
- **Seller**: Property positioning → Market analysis → Presentation strategy → Consultation
- **Investor**: Asset class overview → ROI framework → Lot/property data → Partnership inquiry
- **Rentals**: Simple routing page → Property management partner link

## Technical Notes
- Pure HTML/CSS/JS — no build tools, no framework (yet)
- All JS is vanilla, IIFE-wrapped, no globals
- CSS load order matters: tokens → base → components → sections → responsive
- Logo is PNG at assets/images/logo-transparent.png (not base64)
- Single-file V3 build exists at root as silver-key-realty-v3.html (reference only)
- Primary breakpoint: 900px. Secondary: 480px.
- Grain overlay and ambient green edges are in base.css (body::after, body::before)

## Don't Do These Things
- Don't add new fonts
- Don't use solid green anywhere
- Don't add framework dependencies without discussion
- Don't put inline styles in HTML (except pathway stubs for now)
- Don't use bold (700+) font weights
- Don't create pop-ups, modals, or interstitials
- Don't add stock photography — use typographic/geometric placeholders
- Don't break the atmospheric quality with generic UI patterns

## Backend Architecture
- API lives in /api/ directory (Vercel serverless functions)
- api/submit.js — primary lead intake endpoint
- api/notify.js — email notification via Resend
- Environment variables needed in Vercel dashboard:
  - RESEND_API_KEY (from resend.com)
  - NOTIFICATION_EMAIL (where lead notifications go)
- Forms use class="skr-form" with data-pathway attribute
- forms.js handles all submission logic (assets/js/forms.js)
- Form inputs use .form-input, .form-textarea, .form-label, .form-submit classes
- Green focus state on inputs follows recessed lighting rules (ghost + shadow, not solid)
- Success state replaces form with confirmation message
- No external form services (Formspree, Typeform, etc.) — all native

## Database Architecture (Supabase + PostgreSQL)
- Schema lives in database/schema.sql
- Tables: leads, team_members, lead_activity, consultations, properties, lead_property_interest
- PII (name, email, phone, message) is ALWAYS encrypted with AES-256-GCM before insert
- Email and phone are hashed (HMAC-SHA256) for dedup lookups without decrypting
- Row Level Security (RLS) enabled on every table
- Database triggers auto-log status changes and lead creation
- All timestamps are TIMESTAMPTZ (timezone-aware)
- Soft delete via archived boolean — never hard delete leads

## Security Stack
- api/lib/crypto.js — AES-256-GCM encryption + HMAC-SHA256 hashing
- api/lib/rateLimit.js — per-IP rate limiting (5 submissions per 15 min)
- api/lib/sanitize.js — input validation, XSS stripping, type enforcement
- CORS locked to ALLOWED_ORIGINS array in api/submit.js
- Duplicate detection via email_hash + pathway + 24hr window
- Security headers on all responses (nosniff, DENY framing, strict referrer)
- Environment variables for ALL secrets — zero hardcoded credentials
- .env.example documents required variables

## Environment Variables (set in Vercel dashboard)
- SUPABASE_URL, SUPABASE_SERVICE_KEY, SUPABASE_ANON_KEY
- ENCRYPTION_KEY (32-byte hex string)
- RESEND_API_KEY, NOTIFICATION_EMAIL
- SITE_URL (production domain)
- INTERNAL_API_TOKEN (for internal API-to-API calls)
